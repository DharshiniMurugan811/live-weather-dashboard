<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Live Weather Dashboard - Single File (React CDN)</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: linear-gradient(180deg, #f3f9ff 0%, #e9f4ff 100%);
      --card: #ffffff;
      --muted: #6b7280;
      --accent: #0ea5e9;
      --accent-dark: #0284c7;
      --glass: rgba(255,255,255,0.65);
      font-family: 'Poppins', sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      background:var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      color:#0f172a;
    }
    .container{
      width:100%;
      max-width:920px;
      background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.85));
      border-radius:14px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.12);
      padding:28px;
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255,255,255,0.6);
    }
    header{
      display:flex;
      align-items:center;
      gap:16px;
      margin-bottom:18px;
    }
    header h1{
      font-size:20px;
      margin:0;
      font-weight:700;
    }
    header p{
      margin:0;
      color:var(--muted);
      font-size:13px;
    }
    .search-row{
      display:flex;
      gap:12px;
      margin-top:8px;
    }
    .search-row input[type="text"]{
      flex:1;
      padding:12px 14px;
      border-radius:10px;
      border:1px solid rgba(15,23,42,0.08);
      outline:none;
      font-size:15px;
      box-shadow: 0 4px 10px rgba(2,6,23,0.04) inset;
    }
    .btn{
      padding:10px 14px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:600;
      background:var(--accent);
      color:white;
      transition:transform .12s ease, box-shadow .12s ease;
      box-shadow: 0 6px 18px rgba(14,165,233,0.18);
    }
    .btn.secondary{
      background:transparent;
      border:1px solid rgba(2,6,23,0.06);
      color:var(--accent-dark);
      box-shadow:none;
      font-weight:600;
    }
    .btn:active{transform:translateY(1px)}
    .grid{
      display:grid;
      grid-template-columns: 1fr 340px;
      gap:20px;
      margin-top:20px;
    }
    .panel{
      background:var(--card);
      padding:18px;
      border-radius:12px;
      box-shadow: 0 8px 20px rgba(2,6,23,0.06);
      min-height:180px;
    }
    .weather-main{
      display:flex;
      align-items:center;
      gap:16px;
    }
    .temp{
      font-size:48px;
      font-weight:700;
    }
    .desc{
      text-transform:capitalize;
      color:var(--muted);
      margin-top:4px;
    }
    .meta{
      display:flex;
      gap:12px;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .meta div{
      background:var(--glass);
      padding:8px 10px;
      border-radius:8px;
      font-size:14px;
      color:#0b1220;
    }
    .right-card{
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
      justify-content:center;
      text-align:center;
    }
    .icon-large{width:120px;height:120px}
    .small-note{color:var(--muted); font-size:13px; margin-top:6px;}
    .error{color:#b91c1c; font-weight:600; margin-top:12px;}
    @media (max-width:880px){
      .grid{grid-template-columns:1fr; align-items:stretch}
      .right-card{flex-direction:row; gap:14px; padding:6px 0; text-align:left}
      .icon-large{width:84px;height:84px}
      .temp{font-size:36px}
    }
    footer{margin-top:18px; text-align:center; color:var(--muted); font-size:13px}
  </style>
</head>
<body>
  <div class="container" id="root">
    <!-- React will mount here -->
  </div>

  <!-- React, ReactDOM, and Babel from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <!-- App code -->
  <script type="text/babel">
    const { useState, useEffect } = React;

    function App(){
      const [city, setCity] = useState('');
      const [weather, setWeather] = useState(null);
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState('');
      const API_KEY = "3944425b08987abcdc3868d531c2b848";

      useEffect(() => {
        // Optionally load default city weather (uncomment below)
        // fetchWeatherByName('Tirunelveli');
      }, []);

      const fetchWeatherByName = async (name) => {
        if(!name) return;
        setLoading(true); setError(''); setWeather(null);
        try{
          const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(name)}&appid=${API_KEY}&units=metric`;
          const resp = await fetch(url);
          // quick check
          if(resp.status === 404){
            setError('City not found');
            setLoading(false);
            return;
          }
          const data = await resp.json();
          if(!resp.ok){
            setError((data && data.message) || 'Failed to get weather');
          } else {
            setWeather(data);
          }
        }catch(err){
          setError('Network or API error');
        }finally{
          setLoading(false);
        }
      };

      const fetchWeatherByCoords = async (lat, lon) => {
        setLoading(true); setError(''); setWeather(null);
        try{
          const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`;
          const resp = await fetch(url);
          const data = await resp.json();
          if(!resp.ok){
            setError((data && data.message) || 'Failed to get weather');
          } else {
            setWeather(data);
          }
        }catch(err){
          setError('Network or API error');
        }finally{
          setLoading(false);
        }
      };

      const onSubmit = (e) => {
        e.preventDefault();
        fetchWeatherByName(city.trim());
      };

      const useLocation = () => {
        if(!navigator.geolocation){
          setError('Geolocation not supported in this browser');
          return;
        }
        setLoading(true); setError('');
        navigator.geolocation.getCurrentPosition((pos) => {
          fetchWeatherByCoords(pos.coords.latitude, pos.coords.longitude);
        }, (err) => {
          setLoading(false);
          setError('Permission denied or unavailable');
        });
      };

      return (
        <div>
          <header>
            <div>
              <h1>Live Weather Dashboard</h1>
              <p>Enter a city name or use your location — shows temperature, condition & icon.</p>
            </div>
          </header>

          <form onSubmit={onSubmit} className="search-row" role="search">
            <input
              type="text"
              placeholder="e.g. Tirunelveli, Chennai, New York..."
              value={city}
              onChange={(e)=>setCity(e.target.value)}
              aria-label="City name"
            />
            <button className="btn" type="submit">Search</button>
            <button type="button" className="btn secondary" onClick={useLocation}>Use my location</button>
          </form>

          <div className="grid" style={{marginTop:16}}>
            <div className="panel">
              {loading && <p style={{fontWeight:600}}>Loading...</p>}
              {error && <p className="error">{error}</p>}

              {!loading && !error && !weather && (
                <div style={{padding:20,color:'var(--muted)'}}>Search a city to see its current weather. Try "Tirunelveli".</div>
              )}

              {weather && (
                <div>
                  <div className="weather-main">
                    <div>
                      <div style={{fontSize:14,color:'var(--muted)'}}>Location</div>
                      <div style={{fontWeight:700,fontSize:18}}>{weather.name}, {weather.sys.country}</div>
                      <div className="desc">{weather.weather[0].description}</div>
                      <div className="meta" style={{marginTop:10}}>
                        <div>Feels: {Math.round(weather.main.feels_like)}°C</div>
                        <div>Humidity: {weather.main.humidity}%</div>
                        <div>Wind: {Math.round(weather.wind.speed)} m/s</div>
                      </div>
                    </div>
                    <div style={{marginLeft:'auto',textAlign:'center'}} className="right-card">
                      <img className="icon-large" src={`https://openweathermap.org/img/wn/${weather.weather[0].icon}@4x.png`} alt="icon" />
                      <div className="temp">{Math.round(weather.main.temp)}°C</div>
                      <div className="small-note">Updated: {new Date(weather.dt*1000).toLocaleString()}</div>
                    </div>
                  </div>
                </div>
              )}
            </div>

            <aside className="panel" style={{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center'}}>
              <div style={{fontSize:13,color:'var(--muted)'}}>Quick actions</div>
              <div style={{height:12}}></div>
              <button className="btn" onClick={()=>{ fetchWeatherByName('Tirunelveli'); setCity('Tirunelveli'); }}>Show Tirunelveli</button>
              <div style={{height:10}}></div>
              <button className="btn secondary" onClick={()=>{ setCity(''); setWeather(null); setError(''); }}>Clear</button>
              <div style={{height:12}}></div>
              <div className="small-note">Powered by OpenWeatherMap</div>
            </aside>
          </div>

          <footer>
            <div>Tip: replace the API key in the file if you want to keep it private later.</div>
          </footer>
        </div>
      );
    }

    // Render into container
    const root = document.getElementById('root');
    ReactDOM.createRoot(root).render(<App />);
  </script>
</body>
</html>
